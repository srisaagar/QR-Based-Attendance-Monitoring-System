{"ast":null,"code":"import * as ZXing from \"../third_party/zxing-js.umd\";\nimport { QrcodeResultFormat, Html5QrcodeSupportedFormats } from \"./core\";\nvar ZXingHtml5QrcodeDecoder = function () {\n  function ZXingHtml5QrcodeDecoder(requestedFormats, verbose, logger) {\n    this.formatMap = new Map([[Html5QrcodeSupportedFormats.QR_CODE, ZXing.BarcodeFormat.QR_CODE], [Html5QrcodeSupportedFormats.AZTEC, ZXing.BarcodeFormat.AZTEC], [Html5QrcodeSupportedFormats.CODABAR, ZXing.BarcodeFormat.CODABAR], [Html5QrcodeSupportedFormats.CODE_39, ZXing.BarcodeFormat.CODE_39], [Html5QrcodeSupportedFormats.CODE_93, ZXing.BarcodeFormat.CODE_93], [Html5QrcodeSupportedFormats.CODE_128, ZXing.BarcodeFormat.CODE_128], [Html5QrcodeSupportedFormats.DATA_MATRIX, ZXing.BarcodeFormat.DATA_MATRIX], [Html5QrcodeSupportedFormats.MAXICODE, ZXing.BarcodeFormat.MAXICODE], [Html5QrcodeSupportedFormats.ITF, ZXing.BarcodeFormat.ITF], [Html5QrcodeSupportedFormats.EAN_13, ZXing.BarcodeFormat.EAN_13], [Html5QrcodeSupportedFormats.EAN_8, ZXing.BarcodeFormat.EAN_8], [Html5QrcodeSupportedFormats.PDF_417, ZXing.BarcodeFormat.PDF_417], [Html5QrcodeSupportedFormats.RSS_14, ZXing.BarcodeFormat.RSS_14], [Html5QrcodeSupportedFormats.RSS_EXPANDED, ZXing.BarcodeFormat.RSS_EXPANDED], [Html5QrcodeSupportedFormats.UPC_A, ZXing.BarcodeFormat.UPC_A], [Html5QrcodeSupportedFormats.UPC_E, ZXing.BarcodeFormat.UPC_E], [Html5QrcodeSupportedFormats.UPC_EAN_EXTENSION, ZXing.BarcodeFormat.UPC_EAN_EXTENSION]]);\n    this.reverseFormatMap = this.createReverseFormatMap();\n    if (!ZXing) {\n      throw \"Use html5qrcode.min.js without edit, ZXing not found.\";\n    }\n    this.verbose = verbose;\n    this.logger = logger;\n    var formats = this.createZXingFormats(requestedFormats);\n    var hints = new Map();\n    hints.set(ZXing.DecodeHintType.POSSIBLE_FORMATS, formats);\n    hints.set(ZXing.DecodeHintType.TRY_HARDER, false);\n    this.hints = hints;\n  }\n  ZXingHtml5QrcodeDecoder.prototype.decodeAsync = function (canvas) {\n    var _this = this;\n    return new Promise(function (resolve, reject) {\n      try {\n        resolve(_this.decode(canvas));\n      } catch (error) {\n        reject(error);\n      }\n    });\n  };\n  ZXingHtml5QrcodeDecoder.prototype.decode = function (canvas) {\n    var zxingDecoder = new ZXing.MultiFormatReader(this.verbose, this.hints);\n    var luminanceSource = new ZXing.HTMLCanvasElementLuminanceSource(canvas);\n    var binaryBitmap = new ZXing.BinaryBitmap(new ZXing.HybridBinarizer(luminanceSource));\n    var result = zxingDecoder.decode(binaryBitmap);\n    return {\n      text: result.text,\n      format: QrcodeResultFormat.create(this.toHtml5QrcodeSupportedFormats(result.format)),\n      debugData: this.createDebugData()\n    };\n  };\n  ZXingHtml5QrcodeDecoder.prototype.createReverseFormatMap = function () {\n    var result = new Map();\n    this.formatMap.forEach(function (value, key, _) {\n      result.set(value, key);\n    });\n    return result;\n  };\n  ZXingHtml5QrcodeDecoder.prototype.toHtml5QrcodeSupportedFormats = function (zxingFormat) {\n    if (!this.reverseFormatMap.has(zxingFormat)) {\n      throw \"reverseFormatMap doesn't have \".concat(zxingFormat);\n    }\n    return this.reverseFormatMap.get(zxingFormat);\n  };\n  ZXingHtml5QrcodeDecoder.prototype.createZXingFormats = function (requestedFormats) {\n    var zxingFormats = [];\n    for (var _i = 0, requestedFormats_1 = requestedFormats; _i < requestedFormats_1.length; _i++) {\n      var requestedFormat = requestedFormats_1[_i];\n      if (this.formatMap.has(requestedFormat)) {\n        zxingFormats.push(this.formatMap.get(requestedFormat));\n      } else {\n        this.logger.logError(\"\".concat(requestedFormat, \" is not supported by\") + \"ZXingHtml5QrcodeShim\");\n      }\n    }\n    return zxingFormats;\n  };\n  ZXingHtml5QrcodeDecoder.prototype.createDebugData = function () {\n    return {\n      decoderName: \"zxing-js\"\n    };\n  };\n  return ZXingHtml5QrcodeDecoder;\n}();\nexport { ZXingHtml5QrcodeDecoder };\n//# sourceMappingURL=zxing-html5-qrcode-decoder.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}